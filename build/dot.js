// Generated by CoffeeScript 1.10.0
(function() {
  var bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  this.Dot = (function() {
    Dot.RADIUS = 1;

    Dot.COLOR = 'white';

    Dot.MASS = 0;

    Dot.SOUND = new Audio('../sounds/chomp.wav');

    function Dot(game, dots) {
      this.collision = bind(this.collision, this);
      this.game = game;
      this.dots = dots;
      this.geometry = new THREE.SphereGeometry(Dot.RADIUS);
      this.material = new THREE.MeshBasicMaterial({
        color: Dot.COLOR
      });
      this.object = new Physijs.SphereMesh(this.geometry, this.material, Dot.MASS);
      this.object._physijs.collision_flags = 4;
      this.object.addEventListener('collision', this.collision);
      this.game.addToScene(this.object);
    }

    Dot.prototype.setPosition = function(x, y, z) {
      this.object.position.set(x, y, z);
      return this.object.__dirtyPosition = true;
    };

    Dot.prototype.collision = function(other_object) {
      if (other_object.name === 'Pacman') {
        this.game.removeFromScene(this.object);
        this.dots.dots.splice(this.dots.dots.indexOf(this), 1);
        this.game.updateScore(this.dots.total - this.dots.dots.length);
        Dot.SOUND.play();
      }
      if (this.dots.dots.length <= 0) {
        document.getElementById('over').innerHTML = 'YOU WIN';
        return document.getElementById('over').style.display = 'block';
      }
    };

    return Dot;

  })();

}).call(this);
